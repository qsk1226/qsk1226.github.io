<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
    四、JVM自动内存管理--虚拟机性能监控，故障处理工具 - 大爷来玩儿啊~
    
    </title>
    <link rel="shortcut icon" href="media/15865826719099/icon.png" type="image/png" />

    
    
    <link href="atom.xml" rel="alternate" title="大爷来玩儿啊~" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/style.min.css">
    <link rel="stylesheet" href="asset/css/doc.css">
    <script src="asset/app.js"></script>
</head>
  <body>
    <section class="hero">
      <div class="hero-head">
          <nav class="navbar" role="navigation" aria-label="main navigation">
              <div class="container">
              <div class="navbar-brand">
                
                <a target="_self" class="navbar-item " href="index.html">博客</a>
                
                <a target="_self" class="navbar-item " href="archives.html">归档</a>
                

                <a role="button" id="navbarSNSRssSwitchBtn" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbarSNSRssButtons">
                  <span aria-hidden="true"></span>
                  <span aria-hidden="true"></span>
                  <span aria-hidden="true"></span>
                </a>
              </div>
            
              <div id="navbarSNSRssButtons" class="navbar-menu">
                <div class="navbar-start">
                  
                </div>
            
                <div class="navbar-end">
                  <div class="navbar-item">
                    <!--buttons start-->
                    <div class="buttons">
                      
                        
                        
                        
                        
                      
                      <a href="atom.xml" target="_blank" title="RSS">
                          <span class="icon is-large has-text-black-bis">
                              <svg class="svg-inline--fa fa-rss fa-w-14 fa-lg" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg><!-- <i class="fas fa-rss fa-lg"></i> -->
                          </span>
                      </a>
                    </div>
                    <!--buttons end-->

                  </div>
                </div>
                </div>
              </div>
            </nav>
      </div>

 <div class="hero-body ct-body"></div>
      
    </section>
    <section class="ct-body">
      <div class="container">
          <div class="columns is-variable bd-klmn-columns is-4 is-centered">
              <div class="column is-four-fifths">
                  <div class="post-body single-content">
                    
                    <h1 class="title">
                            四、JVM自动内存管理--虚拟机性能监控，故障处理工具   
                      </h1>
                     
                    
                      <div class="media">
                            
                            <figure class="media-left">
                              <p class="image is-48x48">
                                
                                  <img class="is-rounded" src="media/15865826719099/avatar.png">
                                
                              </p>
                            </figure>
                            
                            <div class="media-content">
                              <div class="content">
                                <p>
                                 <span class="date">2019/12/26</span>
                                  <span class="tran-posted-in">posted in</span>&nbsp; 
                                  
                                      <span class="posted-in"><a href='JVM%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3.html'>JVM深入理解</a></span>
                                         
                                  

                                   
                                      
                                  <br />
                                  <span class="tran-tags">Tags:</span>&nbsp;
                                  
                                    <a class="tag is-link is-light" href='tag_jvm.html'>#jvm</a>
                                     

                                </p>
                              </div>
                            </div>
                         
                    </div>
                </div>
                  <article class="markdown-body single-content">
                    <p>Netstat -ano findstr 3658</p>

<h2 id="toc_0">jps （虚拟机进程状况工具）</h2>

<p>列出当前机器上正在运行的虚拟机进程，并显示虚拟机执行主类名称与虚拟机的唯一进程ID，jps 从操作系统的临时目录上去找(所以有一些信息可能显示不全)。</p>

<p>-q :仅仅显示进程，<br/>
-m:输出主函数传入的参数. 下的 hello 就是在执行程序时从命令行输入的参数 -l: 输出应用程序主类完整 package 名称或 jar 完整名称.<br/>
-v: 列出 jvm 参数, -Xms20m -Xmx50m 是启动程序指定的 jvm 参数</p>

<pre><code class="language-text">➜  ~ jps
1249 org.jetbrains.idea.maven.server.RemoteMavenServer36
4468 org.jetbrains.jps.cmdline.Launcher
1208
4490 sun.tools.jps.Jps
</code></pre>

<h2 id="toc_1">jstat（虚拟机统计信息监视工具）</h2>

<p>jstat（JVM Statistics Monitoring Tool）是用于监视虚拟机各种运行状态信息的命令行工具。它可以显示本地或者远程虚拟机进程中的类加载、内存、垃圾收集、即时编译等运行时数据。</p>

<p>jstat [ option vmid [interval[s|ms] [count]] ]</p>

<p>option主要分为三类：类加载、垃圾收集、运行期编译状况。<br/>
interval和count代表查询间隔和次数,例如间隔250毫秒查看运行状态10次，</p>

<p><figure><img src="media/15773440983590/15975893994393.jpg" alt=""/></figure></p>

<pre><code class="language-shell">&gt; jstat -gc 4468 250 10
S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
10752.0 10752.0  0.0   4205.5 65536.0  27588.7   175104.0    144.0    16256.0 15720.1 1920.0 1802.4      1    0.004   0      0.000    0.004
</code></pre>

<p>S0C:第一个幸存区(From 区)的大小 S1C:第二个幸存区(To 区)的大小 S0U:第一个幸存区的使用大小 S1U:第二个幸存区的使用大小 EC:伊甸园(Eden)区的大小 EU:伊甸园(Eden)区的使用大小 OC:老年代大小 OU:老年代使用大小 MC:方法区大小 MU:方法区使用大小 CCSC:压缩类空间大小 CCSU:压缩类空间使用大小 YGC:年轻代垃圾回收次数 YGCT:年轻代垃圾回收消耗时间 FGC:老年代垃圾回收次数 FGCT:老年代垃圾回收消耗时间 GCT:垃圾回收消耗总时间</p>

<h2 id="toc_2">vm 参数</h2>

<p>java -XX:+PrintFlagsFinal -version  查看所有高级参数的当前情况</p>

<p>jinfo -flags PrintGC 7825 查看PrintGC 是否开启<br/>
jinfo -flags +PrintGC 7825 开启PrintGC</p>

<p>jmap -heap 20488  显示堆信息 </p>

<pre><code class="language-text">➜  ~ jmap -heap 20488
Attaching to process ID 20488, please wait...
Debugger attached successfully.
Server compiler detected.
JVM version is 25.121-b13

using thread-local object allocation.
Parallel GC with 10 thread(s)

Heap Configuration:
   MinHeapFreeRatio         = 0
   MaxHeapFreeRatio         = 100
   MaxHeapSize              = 4294967296 (4096.0MB)
   NewSize                  = 89128960 (85.0MB)
   MaxNewSize               = 1431306240 (1365.0MB)
   OldSize                  = 179306496 (171.0MB)
   NewRatio                 = 2
   SurvivorRatio            = 8
   MetaspaceSize            = 21807104 (20.796875MB)
   CompressedClassSpaceSize = 1073741824 (1024.0MB)
   MaxMetaspaceSize         = 17592186044415 MB
   G1HeapRegionSize         = 0 (0.0MB)

Heap Usage:
PS Young Generation
Eden Space:
   capacity = 67108864 (64.0MB)
   used     = 8067512 (7.693778991699219MB)
   free     = 59041352 (56.30622100830078MB)
   12.02152967453003% used
From Space:
   capacity = 11010048 (10.5MB)
   used     = 0 (0.0MB)
   free     = 11010048 (10.5MB)
   0.0% used
To Space:
   capacity = 11010048 (10.5MB)
   used     = 0 (0.0MB)
   free     = 11010048 (10.5MB)
   0.0% used
PS Old Generation
   capacity = 179306496 (171.0MB)
   used     = 0 (0.0MB)
   free     = 179306496 (171.0MB)
   0.0% used

2295 interned Strings occupying 161832 bytes.
</code></pre>

<p>jmap -histo 20488  按照数量排名对象<br/>
jmap -histo:live 20488  按照数量排名存活的对象<br/>
jmap -histo:live  20488 | head -10 前十行</p>

<pre><code class="language-text">➜  ~ jmap -histo 20488

 num     #instances         #bytes  class name
----------------------------------------------
   1:           711        5225088  [I
   2:          2151        1535568  [B
   3:          6572         796664  [C
   4:          5022         120528  java.lang.String
   5:           727          82720  java.lang.Class
   6:          1328          60912  [Ljava.lang.Object;
   7:           661          26440  java.util.LinkedHashMap$Entry
   8:           326          16624  [Ljava.lang.String;
   9:           391          12512  java.util.HashMap$Node
  10:            43          12432  [Ljava.util.HashMap$Node;
  11:           152          10944  java.lang.reflect.Field
  12:           328          10496  java.io.File
  13:           405           9720  java.lang.StringBuilder
  14:           138           8832  java.net.URL
  15:           266           8512  java.util.Hashtable$Entry
  16:           135           5400  java.lang.ref.Finalizer
  17:           120           4800  java.lang.ref.SoftReference
  18:           179           4296  java.lang.StringBuffer
  19:            31           4224  [Ljava.util.Hashtable$Entry;
  20:           258           4128  java.lang.Integer
</code></pre>

                  </article>
                  <div class="comments-wrap">
                    <div class="share-comments">
                      

                      

                      
                    </div>
                  </div><!-- end comments wrap -->
              </div>
            </div><!-- end columns -->
      </div><!-- end container -->
    </section>



    <footer class="footer">
        <div class="content has-text-centered">
          <p>
              Copyright &copy; 2019
              Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
              Theme used <a target="_blank" href="https://bulma.io/">Bulma CSS</a>.
          </p>
        </div>
      </footer>



  













<script src="asset/prism.js"></script>



  
    




  </body>
</html>
