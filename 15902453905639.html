<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
    MyBatis面试 - 大爷来玩儿啊~
    
    </title>
    <link rel="shortcut icon" href="media/15865826719099/icon.png" type="image/png" />

    
    
    <link href="atom.xml" rel="alternate" title="大爷来玩儿啊~" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/style.min.css">
    <link rel="stylesheet" href="asset/css/doc.css">
    <script src="asset/app.js"></script>
</head>
  <body>
    <section class="hero">
      <div class="hero-head">
          <nav class="navbar" role="navigation" aria-label="main navigation">
              <div class="container">
              <div class="navbar-brand">
                
                <a target="_self" class="navbar-item " href="index.html">博客</a>
                
                <a target="_self" class="navbar-item " href="archives.html">归档</a>
                

                <a role="button" id="navbarSNSRssSwitchBtn" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbarSNSRssButtons">
                  <span aria-hidden="true"></span>
                  <span aria-hidden="true"></span>
                  <span aria-hidden="true"></span>
                </a>
              </div>
            
              <div id="navbarSNSRssButtons" class="navbar-menu">
                <div class="navbar-start">
                  
                </div>
            
                <div class="navbar-end">
                  <div class="navbar-item">
                    <!--buttons start-->
                    <div class="buttons">
                      
                        
                        
                        
                        
                      
                      <a href="atom.xml" target="_blank" title="RSS">
                          <span class="icon is-large has-text-black-bis">
                              <svg class="svg-inline--fa fa-rss fa-w-14 fa-lg" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg><!-- <i class="fas fa-rss fa-lg"></i> -->
                          </span>
                      </a>
                    </div>
                    <!--buttons end-->

                  </div>
                </div>
                </div>
              </div>
            </nav>
      </div>

 <div class="hero-body ct-body"></div>
      
    </section>
    <section class="ct-body">
      <div class="container">
          <div class="columns is-variable bd-klmn-columns is-4 is-centered">
              <div class="column is-four-fifths">
                  <div class="post-body single-content">
                    
                    <h1 class="title">
                            MyBatis面试   
                      </h1>
                     
                    
                      <div class="media">
                            
                            <figure class="media-left">
                              <p class="image is-48x48">
                                
                                  <img class="is-rounded" src="media/15865826719099/avatar.png">
                                
                              </p>
                            </figure>
                            
                            <div class="media-content">
                              <div class="content">
                                <p>
                                 <span class="date">2020/05/23</span>
                                  <span class="tran-posted-in">posted in</span>&nbsp; 
                                  
                                      <span class="posted-in"><a href='mybatis.html'>mybatis</a></span>
                                         
                                  

                                   
                                      
                                  <br />
                                  <span class="tran-tags">Tags:</span>&nbsp;
                                     

                                </p>
                              </div>
                            </div>
                         
                    </div>
                </div>
                  <article class="markdown-body single-content">
                    <ul>
<li><p>MyBatis 的好处是什么？</p>
<ul>
<li>MyBatis 把 sql 语句从 Java 源程序中独立出来，放在单独的 XML 文件中编写， 给程序的维护带来了很大便利。 </li>
<li>MyBatis 封装了底层 JDBC API 的调用细节，并能自动将结果集转换成 Java Bean 对象，大大简化了 Java 数据库编程的重复工作。 </li>
<li>因为 MyBatis 需要程序员自己去编写 sql 语句，程序员可以结合数据库自身的 特点灵活控制 sql 语句，因此能够实现比 Hibernate 等全自动 orm 框架更高的查 询效率，能够完成复杂查询</li>
</ul></li>
</ul>

<hr/>

<ul>
<li>为什么说 Mybatis 是半自动 ORM 映射工具？它与全自动的区别在哪里？<br/>
答：Hibernate 属于全自动 ORM 映射工具，使用 Hibernate 查询关联对象或者关联集 合对象时，可以根据对象关系模型直接获取，所以它是全自动的。而 Mybatis 在查询 关联对象或关联集合对象时，需要手动编写 sql 来完成，所以，称之为半自动 ORM 映<br/>
射工具。</li>
</ul>

<hr/>

<ul>
<li>接口绑定有几种实现方式,分别是怎么实现的?<br/>
答：接口绑定有两种实现方式,一种是通过注解绑定,就是在接口的方法上面加上 @Select@Update 等注解里面包含 Sql 语句来绑定,另外一种就是通过 xml 里面写 SQL 来绑定,在这种情况下,要指定 xml 映射文件里面的 namespace 必须为接口的全 路径名。</li>
</ul>

<hr/>

<ul>
<li>resultType 和 resultMap 的区别？<br/>
答：resultType 和 resultMap 都是表示数据库表与 pojo 之间的映射规则的。类的名字和数据 库相同时，可以直接设置 resultType 参数为 Pojo 类。若不同或者有关联查询，需要设置 resultMap 将结果名字和 Pojo 名字进行转换；从编程的最佳实践来讲，强制使用resultMap, 不要用 resultClass 当返回参数，即使所有类属性名与数据库字段一一对应，也需要定义； </li>
</ul>

<hr/>

<ul>
<li>在 MyBatis 中如何在 mapper 接口中传入多个参数？<br/>
答：MyBatis 的接口默认只支持一个入参，如果要传递多个参数有三种方式：
<ul>
<li>使用 map 传递参数  可读性差，导致可维护性和可扩展性差，杜绝使用</li>
<li>使用注解传递参数 直观明了，当参数较少一般小于 5 个的时候，建议使用</li>
<li>使用 Java Bean 的方 式传递参数</li>
</ul></li>
</ul>

<hr/>

<ul>
<li><p><code>问${}和#{}的区别是什么？</code><br/>
答：向 sql 语句中传递的可变参数,分为预编译#{}和传值${}两种 </p>
<ul>
<li>预编译 #{}：将传入的数据都当成一个字符串，会对自动传入的数据加一个单引号，能 够很大程度防止 sql 注入； </li>
<li> 传值\({}：传入的数据直接显示生成在 sql 中，无法防止 sql 注入；适用场景：动态报表， 表名、选取的列是动态的，orderby 和 in 操作， 可以考虑使用\)</li>
</ul></li>
</ul>

<hr/>

<ul>
<li>通过 Mybatis 怎么样进行批量插入操作<br/>
答：有两种方式：
<ul>
<li>通过 foreach 动态拼装 SQL 语句 </li>
<li> 使用 BATCH 类型的 excutor； 而且这两种方式都能返回数据库主键字段；</li>
</ul></li>
</ul>

<hr/>

<ul>
<li><p>Mybatis 怎么样实现关联查询<br/>
答：有两种方式：</p>
<ul>
<li><p>嵌套结果:使用嵌套结果映射来处理重复的联合结果的子集。使用 join 查询，一部分<br/>
列是 A 对象的属性值，另外一部分列是关联对象 B 的属性值，好处是只发一个 sql 查询，就可以把主对象和其关联对象查出来。 </p></li>
<li><p>嵌套查询:通过执行另外一个 SQL 映射语句来返回预期的复杂类型，在关联标签中配 置 select、fetchType 这样的属性实现，是通过发送多段 SQL 实现的；</p></li>
</ul></li>
</ul>

<hr/>

<ul>
<li>什么是 N+1 问题，怎么解决？<br/>
答：嵌套查询会导致“N+1 查询问题” ，导致该问题产生的原因: 
<ul>
<li>你执行了一个单独的 SQL 语句来获取结果列表(就是“+1”)。 </li>
<li>对返回的每条记录,你执行了一个查询语句来为每个加载细节(就是“N”)。 这个问题会导致成百上千的 SQL 语句被执行。这通常不是期望的。 <br/>
解决“N+1 查询问题”的办法就是开启懒加载、按需加载数据，开启懒加载配置： 在select 节点上配置“fetchType=lazy”，在 MyBatis 核心配置文件中加入如下配置：</li>
</ul></li>
</ul>

<pre><code class="language-text">&lt;!-- 开启懒加载 ，当启用时，有延迟加载属性的对象在被调用时将会完全加载任意属性。否则，每 种属性将会按需要加载。默认：true --&gt; 
&lt;setting name=&quot;aggressiveLazyLoading&quot; value=&quot;false&quot; /&gt;
</code></pre>

<hr/>

<ul>
<li>什么是一级缓存？怎么理解二级缓存？<br/>
答：一级缓存存在于 SqlSession 的生命周期中，在同一个 SqlSession 中查询时使用。二级缓存 也叫应用缓存，存在于 SqlSessionFactory 的生命周期中，可以理解为跨 sqlSession；二级缓存是 以 namespace 为单位的，不同 namespace 下的操作互不影响。在项目中为了避免脏读的问题， 建议不适用二级缓存。</li>
</ul>

<hr/>

<ul>
<li>Mybatis 是如何进行分页的？分页插件的原理是什么？<br/>
答： 
<ul>
<li>Mybatis 使用 RowBounds 对象进行分页，也可以直接编写 sql 实现分页，也可以使用 Mybatis 的分页插件。 </li>
<li>分页插件的原理：实现 Mybatis 提供的接口，实现自定义插件，在插件的拦截方法内拦 截待执行的 sql，然后重写 sql。 举例： select <em>from student，拦截 sql 后重写为： select t.</em> from（select * from student） t limit 0，10</li>
</ul></li>
</ul>

<hr/>

<ul>
<li>简述 Mybatis 的插件运行原理，以及如何编写一个插件？<br/>
答： 
<ul>
<li>Mybatis 仅可以编写针对 ParameterHandler、 ResultSetHandler、 StatementHandler、 Executor 这 4 种接口的插件，Mybatis 通过动态代理，为需要拦截的接口生成代理 对象以实现接口方法拦截功能，每当执行这 4 种接口对象的方法时，就会进入拦 截方法，具体就是 InvocationHandler 的 invoke()方法，当然，只会拦截那些你指定需要拦截的方法。</li>
<li>实现 Mybatis 的 Interceptor 接口并复写 intercept()方法，然后在给插件编写 注解，指定要拦截哪一个接口的哪些方法即可，记住，别忘了在配置文件中配置你 编写的插件。</li>
</ul></li>
</ul>

<hr/>

<ul>
<li>Mybatis 的 Xml 映射文件中，不同的 Xml 映射文件，id 是否可以重复？<br/>
答：不同的 Xml 映射文件，如果配置了 namespace，那么 id 可以重复；如果没有配置 namespace， 那么 id 不能重复；毕竟 namespace 不是必须的，只是最佳实践而已。原因就是 namespace+id 是作为 Map<String, MappedStatement>的 key 使用的，如果没有 namespace，就剩下 id， 那么，id 重复会导致数据互相覆盖。有了 namespace，自然 id 就可以重复，namespace 不同， namespace+id 自然也就不同。</li>
</ul>

<hr/>

<ul>
<li>Mybatis 都有哪些 Executor 执行器？它们之间的区别是什么？<br/>
答：Mybatis 有三种基本的 Executor 执行器，SimpleExecutor、ReuseExecutor、BatchExecutor。
<ul>
<li>SimpleExecutor：Mybatis 的默认执行器，每执行一次 update 或 select，就开启一个 Statement 对 象，用完立刻关闭 Statement 对象。</li>
<li>ReuseExecutor：执行 update 或 select，以 sql 作为 key 查找 Statement 对象，存在就使用，不存在就创建，用完后，不关闭 Statement 对象，而是放 置于 Map3）BatchExecutor：完成批处理。</li>
</ul></li>
</ul>

<hr/>

<ul>
<li>使用 MyBatis 的 mapper 接口调用时有哪些要求？<br/>
答： 
<ul>
<li>Mapper 接口方法名和 mapper.xml 中定义的每个 sql 的 id 相同； </li>
<li> Mapper 接口方法的输入参数类型和 mapper.xml 中定义的每个 sql 的 parameterType 的 类型相同； </li>
<li>  Mapper 接口方法的输出参数类型和 mapper.xml 中定义的每个 sql 的 resultType 的类型 相同； </li>
<li>  Mapper.xml 文件中的 namespace 即是 mapper 接口的类路径。</li>
</ul></li>
</ul>

<hr/>

<ul>
<li>为什么使用 mapper 接口就能对数据库进行访问？<br/>
答：表面上我们在使用 mapper 接口访问数据库，实际 MyBatis 通过动态代理生成了 mapper 接 口的实现类，通过这个动态生成的实现类，将数据库的访问请求转发给 SqlSession。转发过程中 需要实现三个翻译： 
<ul>
<li>通过 sql 语句的类型和接口方法的返回参数确定调用 SqlSession 的哪个方法； </li>
<li>将 sql 语句在 MyBatis 中的两维坐标作为第一个参数，传入 SqlSession 的方法；</li>
<li> 将接口传入的参数封装成 map 后作为第二个参数，传入 SqlSession 的方法； 请求转发给 SqlSession 后实现对数据库的访问操作；</li>
</ul></li>
</ul>

                  </article>
                  <div class="comments-wrap">
                    <div class="share-comments">
                      

                      

                      
                    </div>
                  </div><!-- end comments wrap -->
              </div>
            </div><!-- end columns -->
      </div><!-- end container -->
    </section>



    <footer class="footer">
        <div class="content has-text-centered">
          <p>
              Copyright &copy; 2019
              Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
              Theme used <a target="_blank" href="https://bulma.io/">Bulma CSS</a>.
          </p>
        </div>
      </footer>



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

  













<script src="asset/prism.js"></script>



  
    




  </body>
</html>
